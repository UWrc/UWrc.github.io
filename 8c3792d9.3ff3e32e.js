(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{124:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(7),i=(n(0),n(167)),o={id:"containers",title:"Singularity and Docker"},l={unversionedId:"tools/containers",id:"tools/containers",isDocsHomePage:!1,title:"Singularity and Docker",description:"[singularity-hub]: /img/docs/singularity-hub.png 'Singularity Hub'",source:"@site/docs/tools/containers.md",slug:"/tools/containers",permalink:"/docs/tools/containers",version:"current",sidebar:"someSidebar",previous:{title:"Compilers",permalink:"/docs/tools/compilers"},next:{title:"R and Rstudio",permalink:"/docs/tools/r"}},c=[{value:"Singularity",id:"singularity",children:[{value:"Ubuntu <code>apt-get</code> Example",id:"ubuntu-apt-get-example",children:[]},{value:"Singularity Hub",id:"singularity-hub",children:[]}]},{value:"Docker",id:"docker",children:[{value:"Docker Hub",id:"docker-hub",children:[]}]}],s={toc:c};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Have you ever found yourself saying:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"I don't want to use HYAK because I can't install whatever I want? I found this command online and I can't setup the random \"program\" package with ",Object(i.b)("inlineCode",{parentName:"p"},"sudo apt-get install program"),"? Hate HYAK because you somehow want to use Ubuntu?")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"I'm trying to work on my local computer then move it to HYAK and resume without friction? How about you set up something and now want to share that ",Object(i.b)("em",{parentName:"p"},"exact")," compute environment with a collaborator (or vice-versa)?"))),Object(i.b)("p",null,"The answer to either (or both) of those things are containers! Software containers are a way to package everything you need into a file to send around and have it work exactly the same across environments. The most popular containerization format is ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"#docker"}),"Docker")," but that does require administrative access to run natively, so for shared platforms (e.g., HPC clusters like HYAK) an alternative called ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"#singularity"}),"Singularity")," was developed. Almost every Docker container can be seamlessly converted to Singularity so they're effectively interchangable."),Object(i.b)("p",null,"What are the costs, trade offs, or downsides? You might imagine performance or that containerized applications run slower than native ones. This is not always true, in most instances they are near equivalent."),Object(i.b)("h2",{id:"singularity"},"Singularity"),Object(i.b)("p",null,"The official Singularity documentation [",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://sylabs.io/guides/3.7/user-guide/"}),"www"),"] is the best source."),Object(i.b)("h3",{id:"ubuntu-apt-get-example"},"Ubuntu ",Object(i.b)("inlineCode",{parentName:"h3"},"apt-get")," Example"),Object(i.b)("p",null,"Let's say that you want to use ",Object(i.b)("inlineCode",{parentName:"p"},"git")," and the current version of ",Object(i.b)("inlineCode",{parentName:"p"},"git")," on HYAK is 1.8.3.1 as shown below."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell-session",metastring:"terminal=true",terminal:"true"}),"$ which git \n/usr/bin/git\n$ git --version\ngit version 1.8.3.1\n$ \n")),Object(i.b)("p",null,"Let's say you want a newer version AND you also want it running on Ubuntu for some reason. Here we'll walk you through installing the latest ",Object(i.b)("inlineCode",{parentName:"p"},"git")," binary using ",Object(i.b)("inlineCode",{parentName:"p"},"apt")," repositories for Ubuntu 16.04 [",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://releases.ubuntu.com/16.04/"}),"www"),'] or "Xenial Xerus".'),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Get a build node using some variant of the below command.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"srun -p build --time=1:00:00 -n 2 --mem=15G --pty $0\n")),Object(i.b)("ol",{start:2},Object(i.b)("li",{parentName:"ol"},"Load the Singularity module.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"module load singularity\n")),Object(i.b)("ol",{start:3},Object(i.b)("li",{parentName:"ol"},"Create a Singularity definition file. Mine is below called ",Object(i.b)("inlineCode",{parentName:"li"},"tools.def")," to install the latest ",Object(i.b)("inlineCode",{parentName:"li"},"curl")," and ",Object(i.b)("inlineCode",{parentName:"li"},"git")," binaries from the Ubuntu repositories.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-dockerfile"}),"Bootstrap: docker\nFrom: ubuntu:16.04\n%post\n    apt -y update\n    apt -y install curl git\n\n")),Object(i.b)("ol",{start:4},Object(i.b)("li",{parentName:"ol"},"Built a Singularity container from its definition file. The generated SIF file is your portable container.")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"singularity build --fakeroot tools.sif tools.def\n")),Object(i.b)("ol",{start:5},Object(i.b)("li",{parentName:"ol"},"Run the binary.")),Object(i.b)("p",null,"You'll do this through the ",Object(i.b)("inlineCode",{parentName:"p"},"singularity")," executable to distinguish it from the ",Object(i.b)("inlineCode",{parentName:"p"},"git")," binary in the main operation system."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell-session",metastring:"terminal=true",terminal:"true"}),"$ singularity exec tools.sif git --version            \ngit version 2.7.4\n$ \n")),Object(i.b)("p",null,"Notice the ",Object(i.b)("inlineCode",{parentName:"p"},"git")," version here is newer than the original we started with. Success!"),Object(i.b)("h3",{id:"singularity-hub"},"Singularity Hub"),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"/img/docs/singularity-hub.png",alt:"singularity-hub",title:"Singularity Hub"}))),Object(i.b)("p",null,"The biggest collection of native Singularity images is at Singularity Hub [",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://singularity-hub.org"}),"www"),"]."),Object(i.b)("h2",{id:"docker"},"Docker"),Object(i.b)("p",null,"asdf"),Object(i.b)("h3",{id:"docker-hub"},"Docker Hub"),Object(i.b)("p",null,Object(i.b)("img",Object(a.a)({parentName:"p"},{src:"/img/docs/docker-hub.png",alt:"docker-hub",title:"Docker Hub"}))),Object(i.b)("p",null,"The biggest collection of Docker images is from Docker Hub [",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://hub.docker.com"}),"www"),"]."))}u.isMDXComponent=!0},167:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),u=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=u(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),b=u(n),m=a,d=b["".concat(o,".").concat(m)]||b[m]||p[m]||i;return n?r.a.createElement(d,l(l({ref:t},s),{},{components:n})):r.a.createElement(d,l({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);
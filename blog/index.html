<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="HYAK Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="HYAK Blog Atom Feed"><title data-react-helmet="true">Blog | HYAK</title><meta data-react-helmet="true" property="og:title" content="Blog | HYAK"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/logos/uw_icon.png"><link rel="stylesheet" href="/styles.3966499e.css">
<link rel="preload" href="/styles.d5386c7c.js" as="script">
<link rel="preload" href="/runtime~main.9b33a0a8.js" as="script">
<link rel="preload" href="/main.b316ed8a.js" as="script">
<link rel="preload" href="/1.e83048d8.js" as="script">
<link rel="preload" href="/2.5b945aff.js" as="script">
<link rel="preload" href="/ccc49370.e9f583f4.js" as="script">
<link rel="preload" href="/98.a4a84fac.js" as="script">
<link rel="preload" href="/e175ffcb.5a1efc36.js" as="script">
<link rel="preload" href="/f207a6fb.b25210ad.js" as="script">
<link rel="preload" href="/e5fbabb7.7520629d.js" as="script">
<link rel="preload" href="/ae1b97ef.acc2335a.js" as="script">
<link rel="preload" href="/e91fef21.85e33a1f.js" as="script">
<link rel="preload" href="/23cb1447.9ae051ff.js" as="script">
<link rel="preload" href="/b2b675dd.16f98cd1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logos/uw_icon.png" alt="HYAK Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/uw_icon.png" alt="HYAK Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Research Computing</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/systems">Systems</a><a class="navbar__item navbar__link" href="/pricing">Pricing</a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/about">About</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/about">Supporting You</a></li><li><a class="dropdown__link" href="/team">Our Team</a></li><li><a class="dropdown__link" href="/board">Governance Board</a></li><li><a class="dropdown__link" href="/publications">Publications</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logos/uw_icon.png" alt="HYAK Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/uw_icon.png" alt="HYAK Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Research Computing</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/">Home</a></li><li class="menu__list-item"><a class="menu__link" href="/systems">Systems</a></li><li class="menu__list-item"><a class="menu__link" href="/pricing">Pricing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs">Documentation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" role="button" href="/about">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/about">Supporting You</a></li><li class="menu__list-item"><a class="menu__link" href="/team">Our Team</a></li><li class="menu__list-item"><a class="menu__link" href="/board">Governance Board</a></li><li class="menu__list-item"><a class="menu__link" href="/publications">Publications</a></li></ul></li></ul></div></div></div></nav><div class="scroll-notifier" style="visibility:hidden;width:100%"></div><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2021/02/25/klone-soft-launch">Klone Soft Launch</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2021/01/10/pytorch-cuda11">Pytorch and CUDA11</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2021/01/09/gromacs-gpu">gromacs on GPUs</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2021/01/01/hello-world">Hello world!</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/blog/2020/12/14/scrna-seq">scRNA-seq</a></li></ul></div></div><main class="col col--8"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2021/02/25/klone-soft-launch">Klone Soft Launch</a></h2><div class="margin-vert--md"><time datetime="2021-02-25T00:00:00.000Z" class="blogPostDate_Ta7i">February 25, 2021  · 3 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/npho" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/1252858?s=400&amp;v=4" alt="Nam Pho"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/npho" target="_blank" rel="noreferrer noopener">Nam Pho</a></h4><small class="avatar__subtitle">Director for Research Computing</small></div></div></header><section class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>This page will be updated in the evening once every few days starting from soft launch on February 25, 2021 through the full launch to the UW community. Please check back regularly and scroll to the bottom (or click the latest date on the right) for the latest updates.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="february-25-2021"></a>February 25, 2021<a class="hash-link" href="#february-25-2021" title="Direct link to heading">#</a></h3><p>The UW research computing team celebrates the soft launch of project KLONE, the 3rd generation HYAK supercomputer. Welcome to those researchers invited to participate in the early access program 🥳 🎉</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>There will be weekly maintenance days on Tuesday during the soft launch period after which we will move back to our regular cadence of monthly maintenance windows.</p></div></div><p>The user documentation [<a href="/docs/">link</a>] has been updated to reflect the changes and new features of KLONE but this will be an ongoing process.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compute"></a>Compute<a class="hash-link" href="#compute" title="Direct link to heading">#</a></h4><ul><li>Soft launch with 1,920 compute cores over 48 nodes:<ul><li>27 x <code>mem1</code> nodes (192GB of memory each) in the <code>compute</code> partition,</li><li>4 x <code>mem2</code> nodes (384GB of memory each) in the <code>compute-bigmem</code> partition,</li><li>16 x <code>mem3</code> nodes (768GB of memory each) in the <code>compute-hugemem</code> partition.</li></ul></li><li><code>build</code> nodes no longer exist on klone as they did on mox. All instances have the potential to be interactive and all have internet routing by default (even non-interactive jobs).</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="storage"></a>Storage<a class="hash-link" href="#storage" title="Direct link to heading">#</a></h4><ul><li><code>gscratch</code> on klone is 1.4PB total capacity with a <strong>new</strong> 500TB NVMe flash tier. Data tiering happens automagically, if you use a file frequently it will be moved to the faster storage.</li><li>Storage quota is still charged back at the same rate ($10 / TB / month). Researchers receive 1TB per node purchased and contributed to klone.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="data"></a>Data<a class="hash-link" href="#data" title="Direct link to heading">#</a></h4><ul><li><code>gscratch</code> is <strong>not backed up</strong> that is the responsibility of the researcher (e.g., LOLO, the cloud, external hard drive). Feel free to <a href="mailto:help@uw.edu?subject=hyak archive" target="_blank" rel="noopener noreferrer">email</a> us if you have any questions.</li><li>While all nodes have internet access now, transfer data using the login nodes. Login nodes have full 2 x 40 Gbps bandwidth. If you transfer using a compute node interactive session you are limited to 1 x 1 Gbps connection.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="software"></a>Software<a class="hash-link" href="#software" title="Direct link to heading">#</a></h4><ul><li>modules works the same as it did on mox. This is an improved implementation called LMOD on klone compared to environment modules on mox.</li><li>We provide the basic compilers (e.g., GNU, Intel) as modules.</li><li>The HYAK team is encouraging a container first world (i.e., use Singularity).</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="march-3-2021"></a>March 3, 2021<a class="hash-link" href="#march-3-2021" title="Direct link to heading">#</a></h3><p>The updated total is <strong>3,840 cores</strong> and <strong>96 nodes</strong> on klone.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compute-1"></a>Compute<a class="hash-link" href="#compute-1" title="Direct link to heading">#</a></h4><ul><li>Compute has doubled by adding another rack to klone, an additional 1,920 compute cores over 48 nodes: <ul><li>44 x <code>mem1</code> nodes (192GB of memory each) in the <code>compute</code> partition,</li><li>2 x <code>mem2</code> nodes (384GB of memory each) in the <code>compute-bigmem</code> partition,</li><li>2 x <code>mem3</code> nodes (768GB of memory each) in the <code>compute-hugemem</code> partition.</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="software-1"></a>Software<a class="hash-link" href="#software-1" title="Direct link to heading">#</a></h4><ul><li>We created a module for <code>cmake</code>.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="march-5-2021"></a>March 5, 2021<a class="hash-link" href="#march-5-2021" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="storage-1"></a>Storage<a class="hash-link" href="#storage-1" title="Direct link to heading">#</a></h4><ul><li>Implemented <code>usage_report.txt</code> files in the base folder of <code>/gscratch/yourlab/</code> that is updated once an hour to reflect both your block quota and inode capacity usage. This is similar to the <code>gscratch</code> experience on the MOX cluster.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="website"></a>Website<a class="hash-link" href="#website" title="Direct link to heading">#</a></h4><ul><li>We migrated our site from <code>https://UWrc.github.io</code> to its new home at <code>https://hyak.uw.edu</code>! Update your bookmarks and tell your friends.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="march-9-2021"></a>March 9, 2021<a class="hash-link" href="#march-9-2021" title="Direct link to heading">#</a></h3><p>Next update expected in the evening on this date.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/klone">klone</a><a class="margin-horiz--sm" href="/blog/tags/hyak">hyak</a><a class="margin-horiz--sm" href="/blog/tags/hpc">hpc</a><a class="margin-horiz--sm" href="/blog/tags/supercomputer">supercomputer</a><a class="margin-horiz--sm" href="/blog/tags/launch">launch</a><a class="margin-horiz--sm" href="/blog/tags/features">features</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2021/01/10/pytorch-cuda11">Pytorch and CUDA11</a></h2><div class="margin-vert--md"><time datetime="2021-01-10T00:00:00.000Z" class="blogPostDate_Ta7i">January 10, 2021  · 3 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/npho" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/1252858?s=400&amp;v=4" alt="Nam Pho"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/npho" target="_blank" rel="noreferrer noopener">Nam Pho</a></h4><small class="avatar__subtitle">Director for Research Computing</small></div></div></header><section class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>During the January 12, 2021 mox maintenance period long overdue package updates will be applied. The most user impactful upgrade is the GPU driver from to 418.40.04 to 460.27.04 that will allow for CUDA11 support (up from CUDA10).</p></div></div><p>The single biggest research use for GPUs on HYAK is for machine learning and artificial intelligence and the community has been clammoring for CUDA11 support for some time. Unfortunately, it&#x27;s not easy to separate the GPU driver from the node images so it had to wait until the next maintenance window and some testing for non-ML GPU workflows on HYAK like our <a href="/blog/2021/01/09/gromacs-gpu">gromacs</a> users in the molecular dynamics community.</p><p><strong>tl;dr</strong> your existing Pytorch codes should work but if you wanted to use the new features in Pytorch that required CUDA11 you can upgrade Pytorch and it will work.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installing-pytorch-with-cuda11"></a>Installing Pytorch with CUDA11<a class="hash-link" href="#installing-pytorch-with-cuda11" title="Direct link to heading">#</a></h3><p>Since this is now the latest and greatest on HYAK I&#x27;ve taken the opportunity to update the Python documentation on how to install Pytorch with CUDA11 support within a miniconda3 environment, check out the step-by-step <a href="/docs/tools/python">here</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="reverse-compatibility-with-cuda10"></a>Reverse compatibility with CUDA10<a class="hash-link" href="#reverse-compatibility-with-cuda10" title="Direct link to heading">#</a></h3><p>Before the January 12, 2021 cluster maintenance every GPU on HYAK had a driver with CUDA10 and all of your codes were previously compiled against it. To test that the GPU driver update to CUDA11 wouldn&#x27;t impact the most popular machine learning libraries we are compiling Pytorch against our pre-maintenance CUDA10 and testing it against a GPU with the newer CUDA11 installed.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">conda create -p /gscratch/scrubbed/npho/pytorch-cuda10 </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">python</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3.8</span><span class="token plain"> -y</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Activate your new <code>pytorch-cuda10</code> environment:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">conda activate pytorch-cuda10</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>The Pytorch website [<a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener noreferrer">www</a>] has a nice getting started matrix that generates the requisite install commands against CUDA10.</p><p><img src="/img/blog/pytorch-cuda10.png" alt="pytorch-cuda10" title="Pytorch install instructions for pip with CUDA10"></p><p>The command shown above to copy-and-paste below:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">torch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token number" style="color:rgb(247, 140, 108)">1.7</span><span class="token plain">.1+cu101 </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">torchvision</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token number" style="color:rgb(247, 140, 108)">0.8</span><span class="token plain">.2+cu101 </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">torchaudio</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token number" style="color:rgb(247, 140, 108)">0.7</span><span class="token plain">.2 -f https://download.pytorch.org/whl/torch_stable.html</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Now we can load the Python interpreter and confirm Pytorch is installed and the CUDA10 compiled library recognizes this GPU with CUDA11 [<a href="https://pytorch.org/get-started/locally/#linux-verification" target="_blank" rel="noopener noreferrer">www</a>].</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-shell-session codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div style="display:flex"><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ff5f56;margin-left:0"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ffbd2e;margin-left:8px"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#27c93f;margin-left:8px"></div></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pytorch-cuda10) $ python3                                                                               Python 3.8.5 (default, Sep  4 2020, 07:30:14) </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[GCC 7.3.0] :: Anaconda, Inc. on linux</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; import torch</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; torch.__version__</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;1.7.1+cu101&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; torch.cuda.is_available()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">True</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Success! </p><p>Previously compiled libraries against CUDA10 from pre-January 12, 2021 maintenance times should still work on the GPUs now with CUDA11. However, if you want to use the full features of libraries that take advantage of newer capabilities in CUDA11 then you should definitely upgrade your libraries.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/ai">ai</a><a class="margin-horiz--sm" href="/blog/tags/ml">ml</a><a class="margin-horiz--sm" href="/blog/tags/machine-learning">machine learning</a><a class="margin-horiz--sm" href="/blog/tags/pytorch">pytorch</a><a class="margin-horiz--sm" href="/blog/tags/gpu">gpu</a><a class="margin-horiz--sm" href="/blog/tags/cuda">cuda</a><a class="margin-horiz--sm" href="/blog/tags/cuda-11">cuda11</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2021/01/09/gromacs-gpu">gromacs on GPUs</a></h2><div class="margin-vert--md"><time datetime="2021-01-09T00:00:00.000Z" class="blogPostDate_Ta7i">January 9, 2021  · 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/npho" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/1252858?s=400&amp;v=4" alt="Nam Pho"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/npho" target="_blank" rel="noreferrer noopener">Nam Pho</a></h4><small class="avatar__subtitle">Director for Research Computing</small></div></div></header><section class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>During the January 12, 2021 mox maintenance period long overdue package updates will be applied. The most user impactful upgrade is the GPU driver from to 418.40.04 to 460.27.04 that will allow for CUDA 11 support (up from CUDA 10).</p></div></div><p>The second most widely used GPU-enabled workflow on HYAK (besides machine learning) is molecular dynamics (MD) so we wanted to test one of the most popular MD codes, gromacs [<a href="http://www.gromacs.org/About_Gromacs" target="_blank" rel="noopener noreferrer">source</a>], and ensure this driver upgrade wouldn&#x27;t negatively impact our researchers. I couldn&#x27;t find gromacs compiled with GPU support currently in our module collection so I used it as an opportunity to create one for you all, read on!</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This is an excercise to demonstrate the support for molecular dynamics on GPUs as a proof-of-concept. Scientific verification of the software compile options (e.g., single-precision) and its results is the responsibility of the researcher.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-gromacs"></a>Using gromacs<a class="hash-link" href="#using-gromacs" title="Direct link to heading">#</a></h2><p>I&#x27;ll start with the end result for those of you who just want to use it but following that I&#x27;ll dive into the nuts and bolts of how we created the module so you can perform additional optimizations.</p><p>This is a GPU-enabled version of gromacs so we need a GPU first (can verify with <code>nvidia-smi</code>).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">srun -p build-gpu --time</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">:00:00 -n </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> --mem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">20G --gpus</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> --pty </span><span class="token variable" style="color:rgb(191, 199, 213)">$0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="gromacs-20204-module"></a>gromacs-2020.4 module<a class="hash-link" href="#gromacs-20204-module" title="Direct link to heading">#</a></h3><p>Once we have a GPU we use modules to load gromacs-2020.4 and all its required dependencies (e.g., CUDA11).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module load gromacs/2020.4-cuda11.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>All packages are sub-commands of the <code>gmx</code> binary so you can verify the module.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-shell-session codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div style="display:flex"><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ff5f56;margin-left:0"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ffbd2e;margin-left:8px"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#27c93f;margin-left:8px"></div></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ gmx -version</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        :-) GROMACS - gmx, 2020.4 (-:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GROMACS version:    2020.4  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Verified release checksum is 79c2857291b034542c26e90512b92fd4b184a1c9d6fa59c55f2e24ccf14e7281</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Precision:          single  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Memory model:       64 bit  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MPI library:        thread_mpi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">OpenMP support:     enabled (GMX_OPENMP_MAX_THREADS = 64)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GPU support:        CUDA</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SIMD instructions:  AVX_512 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">FFT library:        fftw-3.3.3-sse2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RDTSCP usage:       enabled </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TNG support:        enabled </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Hwloc support:      hwloc-1.11.8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Tracing support:    disabled</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C compiler:         /sw/gcc/10.1.0/bin/gcc GNU 10.1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C compiler flags:   -mavx512f -mfma -fexcess-precision=fast -funroll-all-loops -O3 -DNDEBUG</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C++ compiler:       /sw/gcc/10.1.0/bin/g++ GNU 10.1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C++ compiler flags: -mavx512f -mfma -fexcess-precision=fast -funroll-all-loops -fopenmp -O3 -DNDEBUG</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CUDA compiler:      /sw/cuda/11.1.1-1/bin/nvcc nvcc: NVIDIA (R) Cuda compiler driver;Copyright (c) 2005-2020 NVIDIA Corporation;Built on Mon_Oct_12_20:09:46_PDT_2020;Cuda compilation tools, release 11.1, V11.1.105;Build cuda_11.1.TC455_06.29190527_0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CUDA compiler flags:-gencode;arch=compute_35,code=sm_35;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_52,code=sm_52;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-Wno-deprecated-gpu-targets;-gencode;arch=compute_35,code=compute_35;-gencode;arch=compute_50,code=compute_50;-gencode;arch=compute_52,code=compute_52;-gencode;arch=compute_60,code=compute_60;-gencode;arch=compute_61,code=compute_61;-gencode;arch=compute_70,code=compute_70;-gencode;arch=compute_75,code=compute_75;-gencode;arch=compute_80,code=compute_80;-use_fast_math;;-mavx512f -mfma -fexcess-precision=fast -funroll-all-loops -fopenmp -O3 -DNDEBUG</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CUDA driver:        11.20   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CUDA runtime:       11.10   </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="test-simulation-of-lysozyme"></a>Test simulation of Lysozyme<a class="hash-link" href="#test-simulation-of-lysozyme" title="Direct link to heading">#</a></h3><p>I used a tutorial from the gromacs website <a href="http://www.gromacs.org/@api/deki/files/198/=gmx-tutorial.pdf" target="_blank" rel="noopener noreferrer">here</a> to show it runs processes on GPU(s). The tutorial runs an MD simulation on a lysozyme but that&#x27;s the extent of my study there. The commands below are a summary of the tutorial with a note that the <code>genbox</code> subcommand is now replaced by <code>solvate</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx pdb2gmx -f 1LYD.pdb -water tip3p</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx editconf -f conf.gro -bt dodecahedron -d </span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token plain"> -o box.gro</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx solvate -cp box.gro -cs spc216.gro -p topol.top -o solvated.gro</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx trjconv -s solvated.gro -f solvated.gro -o solvated.pdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx grompp -f em.mdp -p topol.top -c solvated.gro -o em.tpr -maxwarn </span><span class="token number" style="color:rgb(247, 140, 108)">3</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>The final gromacs command below starts the fun, the documentation suggests it will automatically identify the GPUs available to send work to them. However, there are more explicit GPU arguments we encourage you to explore.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">gmx mdrun -v -deffnm em</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>You can <code>ssh</code> into the node you&#x27;re using in a separate window to have a parallel <code>nvidia-smi</code> command run so we can monitor the load on the GPU(s).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-shell-session codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div style="display:flex"><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ff5f56;margin-left:0"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#ffbd2e;margin-left:8px"></div><div style="width:12px;height:12px;margin-bottom:16px;border-radius:50%;background-color:#27c93f;margin-left:8px"></div></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+-------------------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Processes:                                                        |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|  GPU   GI   CI        PID   Type   Process name        GPU Memory |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|        ID   ID                                         Usage      |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|===================================================================|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    0   N/A  N/A    143353      C   gmx                     165MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    1   N/A  N/A    143353      C   gmx                     165MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    2   N/A  N/A    143353      C   gmx                     167MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    3   N/A  N/A    143353      C   gmx                     167MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    4   N/A  N/A    143353      C   gmx                     167MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    5   N/A  N/A    143353      C   gmx                     167MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    6   N/A  N/A    143353      C   gmx                     167MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|    7   N/A  N/A    143353      C   gmx                     165MiB |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+-------------------------------------------------------------------+</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>We can see a process occuping each GPU so it works! At least, gromacs uses GPUs...the GPUs themselves weren&#x27;t stressed heavily and that requires the user to increase the number of rank processes and match that with available GPUs. You can do this by adding arguments to the <code>gmx mdrun</code> command but by default it did 2 ranks per GPU it detected, which is not a lot.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="optional-compile-notes"></a>(Optional) Compile Notes<a class="hash-link" href="#optional-compile-notes" title="Direct link to heading">#</a></h2><p>You need CUDA11, GNU Compiler, and OpenBLAS library for the version I put together but I was focused on a proof-of-concept and not squeezing out every last drop of performance. There&#x27;s a lot of further optimization to be done and that&#x27;s left as an exercise for the reader:</p><ol><li>Try the Intel compiler and see if it provides further optimization for non-GPU parts of the workflow.</li><li>Try other math libraries (e.g., MKL) and see if it speeds things up.</li><li>Add in MPI support if you want to use multiple GPUs across multiple nodes.</li><li>Add in modules (e.g., PLUMED).</li><li>Other stuff I can&#x27;t think of with compile flags [<a href="https://manual.gromacs.org/documentation/2020/install-guide/index.html" target="_blank" rel="noopener noreferrer">here</a>].</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="download-source"></a>Download Source<a class="hash-link" href="#download-source" title="Direct link to heading">#</a></h3><p>From the login node I staged a folder in the <a href="/docs/tools/modules">modules</a> directory.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /sw/gromacs/2020.4-cuda11.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Grab regression tests.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> http://gerrit.gromacs.org/download/regressiontests-2020.4.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Download gromacs-2020.4 [<a href="https://manual.gromacs.org/documentation/2020.4/download.html" target="_blank" rel="noopener noreferrer">source</a>].</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">wget</span><span class="token plain"> ftp://ftp.gromacs.org/pub/gromacs/gromacs-2020.4.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="get-a-gpu-and-code"></a>Get a GPU and Code<a class="hash-link" href="#get-a-gpu-and-code" title="Direct link to heading">#</a></h3><p>I used the shared <code>build-gpu</code> node for an interactive session but if you are affiliated with a group that has their own you can use that instead.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">srun -p build-gpu --time</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">:00:00 -n </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> --mem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">20G --gpus</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> --pty </span><span class="token variable" style="color:rgb(191, 199, 213)">$0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Once you get a session with GPU (you can run <code>nvidia-smi</code> to confirm you see one). Extract regression tests.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> xvzf regressiontests-2020.4.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Do the same for the gromacs code and enter the directory.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> xzvf gromacs-2020.4.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> gromacs-2020.4</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pre-requisite-modules"></a>Pre-requisite Modules<a class="hash-link" href="#pre-requisite-modules" title="Direct link to heading">#</a></h3><p>Modules loaded individually for readability but you could load all modules in one command. Get a refresher on modules <a href="/docs/tools/modules">here</a>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module load cmake/3.11.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module load gcc/10.1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module load cuda/11.1.1-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module load contrib/openblas/0.2.20</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="compile"></a>Compile<a class="hash-link" href="#compile" title="Direct link to heading">#</a></h3><p>I created a subdirectory within the source to compile.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> cuda11</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> cuda11</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>Use <code>cmake</code> to create the <code>Makefile</code>. <strong>Note</strong>: if you copy-and-paste the <code>cmake</code> command below you <em>will</em> have to modify the paths referenced for your environment.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_3RXF"><div tabindex="0" class="prism-code language-bash codeBlock_1wn8 thin-scrollbar"><div class="codeBlockLines_3HrO" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cmake </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain"> -DGMX_BUILD_OWN_FFTW</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OFF -DREGRESSIONTEST_DOWNLOAD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OFF -DGMX_GPU</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ON -DGMX_MPI</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">OFF -DCMAKE_INSTALL_PREFIX</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/sw/gromacs/2020.4-cuda11.1 -DREGRESSIONTEST_PATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/sw/gromacs/2020.4-cuda11.1/regressiontests-2020.4 -DCUDA_TOOLKIT_ROOT_DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/sw/cuda/11.1.1-1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button></div></div><p>With the <code>Makefile</code> ready you can run <code>make -j 4</code> and replace 4 with however many cores you have in your session then <code>make install</code>. I created the module file separately so you can load it with <code>module load gromacs/2020.4-cuda11.1</code> and run the single <code>gmx</code> binary.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/gromacs">gromacs</a><a class="margin-horiz--sm" href="/blog/tags/molecular-dynamics">molecular dynamics</a><a class="margin-horiz--sm" href="/blog/tags/md">md</a><a class="margin-horiz--sm" href="/blog/tags/gpu">gpu</a><a class="margin-horiz--sm" href="/blog/tags/cuda">cuda</a><a class="margin-horiz--sm" href="/blog/tags/cuda-11">cuda11</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2021/01/01/hello-world">Hello world!</a></h2><div class="margin-vert--md"><time datetime="2021-01-01T00:00:00.000Z" class="blogPostDate_Ta7i">January 1, 2021  · 2 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/npho" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/1252858?s=400&amp;v=4" alt="Nam Pho"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/npho" target="_blank" rel="noreferrer noopener">Nam Pho</a></h4><small class="avatar__subtitle">Director for Research Computing</small></div></div></header><section class="markdown"><p>tl;dr (1) decomissioned a cluster, (2) got a bunch of GPUs for maching learning, (3) launched a cluster, and (4) new and improved documentation.</p><p>2020 has definitely been an eventful year but here on Team Hyak we&#x27;ve been trying to make the best of a bad situation (lemons out of lemonade and such). This year saw the decomissioning of the 1<sup>st</sup> generation Hyak cluster, ikt, and the soft launch of our 3<sup>rd</sup> generation Hyak cluster, klone. Our partnership with the Allen School and other departments across campus has enabled an explosion in on-campus GPU capacity for the current 2<sup>nd</sup> generation Hyak cluster, mox. This is all very exciting, machine learning is only going to get bigger. We realize whether you do your research on your laptop, Hyak, or the cloud that at the end of the day it&#x27;s all just a computer and what matters is what you can actually <i>do</i> with it. Therefore, we are placing more emphasis on new and improved documentation (this website) and will be doing more regular research tutorials on Hyak throughout the coming year.</p><p>We hope you have weathered the adversity 2020 brought upon everyone. It has been a tough year for sure, but may your 2021 be brighter and have improvements in store. The Hyak Team has lots of efforts in the works to benefit supporting your research and they will hit full stride in the coming year. This is one improvement we can all look forward to in 2021.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/hello">hello</a><a class="margin-horiz--sm" href="/blog/tags/launch">launch</a><a class="margin-horiz--sm" href="/blog/tags/documentation">documentation</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_3-lP"><a href="/blog/2020/12/14/scrna-seq">scRNA-seq</a></h2><div class="margin-vert--md"><time datetime="2020-12-14T00:00:00.000Z" class="blogPostDate_Ta7i">December 14, 2020  · 1 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/npho" target="_blank" rel="noreferrer noopener"><img src="https://avatars3.githubusercontent.com/u/1252858?s=400&amp;v=4" alt="Nam Pho"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/npho" target="_blank" rel="noreferrer noopener">Nam Pho</a></h4><small class="avatar__subtitle">Director for Research Computing</small></div></div></header><section class="markdown"><p>Over the past year we&#x27;ve done a bunch of outreach to labs within the genomics community here at the UW. Given my research background it&#x27;s where I feel most comfortable and this type of research is underrepresented on the cluster. Given where the field is going it&#x27;s inconceivable they aren&#x27;t using Hyak or HPC in general! Those lab closet clusters and under bench servers gotta go, there is a better way and we&#x27;ll show you how to do some scRNA-seq today 🙂</p><p>TODO</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/genomics">genomics</a><a class="margin-horiz--sm" href="/blog/tags/transcriptomics">transcriptomics</a><a class="margin-horiz--sm" href="/blog/tags/single-cell">single-cell</a><a class="margin-horiz--sm" href="/blog/tags/rna-seq">rna-seq</a><a class="margin-horiz--sm" href="/blog/tags/scrna-seq">scrna-seq</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">HYAK</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/sign-up">Sign Up</a></li><li class="footer__item"><a class="footer__link-item" href="/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/about">About</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Sponsors</h4><ul class="footer__items"><li class="footer__item"><a href="https://artsci.washington.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">College of Arts &amp; Sciences</a></li><li class="footer__item"><a href="https://www.engr.washington.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">College of Engineering</a></li><li class="footer__item"><a href="https://environment.uw.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">College of the Environment</a></li><li class="footer__item"><a href="https://www.ipd.uw.edu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Institute for Protein Design</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contact</h4><ul class="footer__items"><li class="footer__item"><a href="mailto:help@uw.edu?subject=hyak help footer" target="_blank" rel="noopener noreferrer" class="footer__link-item">E-mail</a></li><li class="footer__item"><a href="https://mailman1.u.washington.edu/mailman/listinfo/hyak-users" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li><li class="footer__item"><a href="https://uw-hpcc.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://github.com/uwrc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with ❤️ in Seattle</div></div></div></footer></div>
<script src="/styles.d5386c7c.js"></script>
<script src="/runtime~main.9b33a0a8.js"></script>
<script src="/main.b316ed8a.js"></script>
<script src="/1.e83048d8.js"></script>
<script src="/2.5b945aff.js"></script>
<script src="/ccc49370.e9f583f4.js"></script>
<script src="/98.a4a84fac.js"></script>
<script src="/e175ffcb.5a1efc36.js"></script>
<script src="/f207a6fb.b25210ad.js"></script>
<script src="/e5fbabb7.7520629d.js"></script>
<script src="/ae1b97ef.acc2335a.js"></script>
<script src="/e91fef21.85e33a1f.js"></script>
<script src="/23cb1447.9ae051ff.js"></script>
<script src="/b2b675dd.16f98cd1.js"></script>
</body>
</html>